<h1>New Encounter!</h1>

<div
  data-controller="autoclicker"
  data-autoclicker-rate-value="<%= current_user.auto_click_rate %>"
  data-autoclicker-user-id-value="<%= current_user.id %>">
</div>

<div
  data-controller="money"
  data-money-rate-value="<%= current_user.earn_rate %>"
  data-money-user-id-value="<%= current_user.id %>"
  data-money-count-value="<%= current_user.catch_count%>">
</div>

<% if @pokemon %>
  <% if @is_shiny %>
    <p>You encountered a Shiny <%= @pokemon.name %>!</p>
    <img src="<%= @pokemon.shiny_sprite %>" alt="<%= @pokemon.name %> Shiny Sprite" width="150" height="150">
  <% else %>
    <p>You encountered a <%= @pokemon.name %>!</p>
    <img src="<%= @pokemon.sprite %>" alt="<%= @pokemon.name %> Sprite" width="150" height="150">
  <% end %>
  <%= form_with url: encounters_path, method: :post do %>
    <%= hidden_field_tag :pokemon_id, @pokemon.id %>
    <%= hidden_field_tag :shiny, @is_shiny %>
    <%= submit_tag "Catch Pokémon!" %>
  <% end %>

<% else %>
  <p>No Pokémon encountered yet. Try again!</p>
  <%= link_to 'Try Again', new_encounter_path %>
<% end %>

<!-- Add a button to go to the user's profile -->
<%= link_to 'View Profile', profile_path, class: 'button' %>

<%= turbo_frame_tag "stats" do %>
  <%= render "stats", user: current_user %>
<% end %>

<% base_cost = 100 %>
<% next_cost = (base_cost * (1.15 ** current_user.trainers)).to_i %>

<div data-controller="trainers">
  <button
    data-action="click->trainers#buyTrainer"
    data-trainers-target="button">
    Hire Trainer (Cost: <%= next_cost %>)
  </button>
</div>